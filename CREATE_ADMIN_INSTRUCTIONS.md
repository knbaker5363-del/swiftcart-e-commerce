# ุฅูุดุงุก ุญุณุงุจ Admin - ุทุฑููุชุงู

## โ ุงูุทุฑููุฉ 1: ูู ุตูุญุฉ Login ูุจุงุดุฑุฉ (ุงูุฃุณูู)

### ุงูุฎุทูุงุช:

1. **ุงูุชุญ ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู:** `/admin/login`

2. **ุงุถุบุท ุนูู "ุฅูุดุงุก ุญุณุงุจ ูุณุคูู ุฌุฏูุฏ"** ูู ุฃุณูู ุงูุตูุญุฉ

3. **ุงููุฃ ุงููููุฐุฌ:**
   - ุงูุงุณู ุงููุงูู (ุงุฎุชูุงุฑู)
   - ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
   - ูููุฉ ุงููุฑูุฑ (6 ุฃุญุฑู ุนูู ุงูุฃูู)
   - **ููุฏ ุงูุฅูุดุงุก ุงูุณุฑู** - ุงูุฐู ุฃุฏุฎูุชู ูู `ADMIN_CREATION_CODE`

4. **ุงุถุบุท "ุฅูุดุงุก ุญุณุงุจ Admin"**

5. **ุณูุชู ุฅูุดุงุก ุงูุญุณุงุจ ุชููุงุฆูุงู** ูุน ุตูุงุญูุงุช admin ูุงููุฉ

6. **ุณุฌู ุฏุฎูู** ุจุงุณุชุฎุฏุงู ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ

---

## ๐ ุฃูุงู ููุฏ ุงูุฅูุดุงุก

ุงูููุฏ ุงูุณุฑู (`ADMIN_CREATION_CODE`) ููุฌูุฏ ูู:
- **Settings โ Secrets** ูู Lovable
- ูุญูู ููุง ูููู ุงููุตูู ุฅููู ูู ุงููุชุตูุญ
- ูุชู ุงูุชุญูู ููู server-side ูู Edge Function
- ุจุฏูู ุงูููุฏ ุงูุตุญูุญุ ูุง ูููู ูุฃุญุฏ ุฅูุดุงุก admin

---

## ๐ ุงูุทุฑููุฉ 2: ููุฏ Console (ุงูุจุฏูู)

ุฅุฐุง ููุช ุชูุถู ุงูุทุฑููุฉ ุงููุฏููุฉ ุฃู ูุฏูู ูุดููุฉ:

### ุงูุฎุทูุงุช:

1. **ุงูุชุญ ุงููููุน** ูู ุงููุชุตูุญ (ุฃู ุตูุญุฉ)

2. **ุงูุชุญ Console ูู ุงููุชุตูุญ:**
   - **Chrome/Edge**: ุงุถุบุท `F12` ุฃู `Ctrl+Shift+J` (Windows) / `Cmd+Option+J` (Mac)
   - **Firefox**: ุงุถุบุท `F12` ุฃู `Ctrl+Shift+K` (Windows) / `Cmd+Option+K` (Mac)
   - **Safari**: `Cmd+Option+C`

3. **ุงูุณุฎ ูุงูุตู ูุฐุง ุงูููุฏ** ูู Console:

```javascript
(async function createAdmin() {
  const email = prompt("ุฃุฏุฎู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ููุฃุฏูู:");
  if (!email) {
    alert("ูุฌุจ ุฅุฏุฎุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู");
    return;
  }

  const password = prompt("ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ (6 ุฃุญุฑู ุนูู ุงูุฃูู):");
  if (!password || password.length < 6) {
    alert("ูููุฉ ุงููุฑูุฑ ูุฌุจ ุฃู ุชููู 6 ุฃุญุฑู ุนูู ุงูุฃูู");
    return;
  }

  const fullName = prompt("ุฃุฏุฎู ุงูุงุณู ุงููุงูู (ุงุฎุชูุงุฑู):");
  const creationCode = prompt("ุฃุฏุฎู ููุฏ ุงูุฅูุดุงุก ุงูุณุฑู:");

  if (!creationCode) {
    alert("ููุฏ ุงูุฅูุดุงุก ูุทููุจ");
    return;
  }

  console.log("ุฌุงุฑู ุฅูุดุงุก ุงูุญุณุงุจ...");

  try {
    // Import Supabase client
    const { createClient } = await import('https://esm.sh/@supabase/supabase-js@2');
    
    const supabaseUrl = 'https://ghsiifbeszsrpqwbpopr.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imdoc2lpZmJlc3pzcnBxd2Jwb3ByIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ0Nzg4NjcsImV4cCI6MjA4MDA1NDg2N30.q-1Q0hiNW06QUqejF9uGlQdyZOom7IcBE7setn8ohn0';
    
    const supabase = createClient(supabaseUrl, supabaseKey);

    const { data, error } = await supabase.functions.invoke('create-admin', {
      body: {
        email: email,
        password: password,
        fullName: fullName,
        creationCode: creationCode,
      },
    });

    if (error) {
      alert("โ ุฎุทุฃ: " + error.message);
      console.error("Error:", error);
      return;
    }

    if (data?.error) {
      alert("โ ุฎุทุฃ: " + data.error);
      console.error("Error:", data);
      return;
    }

    console.log("โ ุชู ุฅูุดุงุก ุญุณุงุจ Admin ุจูุฌุงุญ!");
    alert("โ ุชู ุฅูุดุงุก ุญุณุงุจ Admin ุจูุฌุงุญ!\n\nููููู ุงูุขู ุชุณุฌูู ุงูุฏุฎูู ูู:\n/admin/login");

  } catch (error) {
    console.error("โ ุฎุทุฃ:", error);
    alert("ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅูุดุงุก ุงูุญุณุงุจ: " + error.message);
  }
})();
```

---

## ๐ก ููุงุญุธุงุช ูููุฉ

### ุงูุฃูุงู:
- โ **ูุญูู ุชูุงูุงู**: ุงูููุฏ ุงูุณุฑู ูุชู ุงูุชุญูู ููู server-side
- โ **ูุง ูููู ุงูุชูุงุนุจ**: RLS policies ุชููุน ุฅุถุงูุฉ admin role ูุฏููุงู
- โ **Edge Function**: ูู ุงูุนูููุงุช ุชุชู ุนุจุฑ ุฏุงูุฉ ุขููุฉ
- ๐ **ุงูุณุฑูุฉ**: ูุง ุชุดุงุฑู ููุฏ ุงูุฅูุดุงุก ูุน ุฃุญุฏ

### ุงูุงุณุชุฎุฏุงู:
- ๐ **ุงุณุชุฎุฏู ุงูุทุฑููุฉ 1** ููุณุฑุนุฉ ูุงูุณูููุฉ
- ๐ป **ุงุณุชุฎุฏู ุงูุทุฑููุฉ 2** ุฅุฐุง ููุช ุชูุถู Console ุฃู ูุฏูู ูุดููุฉ
- โ๏ธ **ุงุญูุธ ุจูุงูุงุช ุชุณุฌูู ุงูุฏุฎูู** ูู ููุงู ุขูู

### ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู:
- **ุฅูุดุงุก ุนุฏุฉ admins**: ูุฑุฑ ุงูุนูููุฉ ุจุฅููููุงุช ูุฎุชููุฉ
- **ุญุฐู ุตูุงุญูุงุช admin**: ูู Backend โ Database โ user_roles
- **ุชุบููุฑ ุงูููุฏ ุงูุณุฑู**: Settings โ Secrets โ ADMIN_CREATION_CODE

---

## ๐ ุงูุชุญูู ูู ูุฌุงุญ ุงูุนูููุฉ

### ูู ูุงุฌูุฉ Backend:
1. ุงูุชุญ Backend (Lovable Cloud)
2. ุงุฐูุจ ุฅูู Database โ Tables โ user_roles
3. ุงุจุญุซ ุนู ุงููุณุชุฎุฏู ุงูุฌุฏูุฏ ุจู role = 'admin'

### ูู SQL Editor:
```sql
-- ุนุฑุถ ุฌููุน ุงููุณุคูููู
SELECT 
  p.email, 
  p.full_name,
  ur.role,
  ur.created_at
FROM public.profiles p
JOIN public.user_roles ur ON p.id = ur.user_id
WHERE ur.role = 'admin';
```

---

## โ ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ

**ุณ: ูุงุฐุง ูู ูุณูุช ููุฏ ุงูุฅูุดุงุกุ**
ุฌ: ุงุฐูุจ ุฅูู Settings โ Secrets ูู Lovable ูุฃุถู ููุฏ ุฌุฏูุฏ

**ุณ: ูู ูููู ุฅูุดุงุก ุฃูุซุฑ ูู adminุ**
ุฌ: ูุนูุ ุงุณุชุฎุฏู ุฃู ูู ุงูุทุฑููุชูู ููู admin ุฌุฏูุฏ

**ุณ: ููู ุฃุญุฐู ุตูุงุญูุงุช adminุ**
ุฌ: ูู Backend:
```sql
DELETE FROM public.user_roles 
WHERE user_id = 'user-id-here' AND role = 'admin';
```

**ุณ: ูุงุฐุง ูู ุฃุฎุทุฃุช ูู ููุฏ ุงูุฅูุดุงุกุ**
ุฌ: ุณุชุธูุฑ ุฑุณุงูุฉ ุฎุทุฃ ููู ูุชู ุฅูุดุงุก ุงูุญุณุงุจ

**ุณ: ูู ุงูููุฏ ุงูุณุฑู ุขููุ**
ุฌ: ูุนูุ ูุญููุธ ูู Secrets ููุชู ุงูุชุญูู ููู server-side ููุท

---

## ๐ฏ ุงูููุงุฑูุฉ ุจูู ุงูุทุฑููุชูู

| ุงูููุฒุฉ | ุตูุญุฉ Login | Console |
|--------|-----------|---------|
| ุงูุณูููุฉ | โญโญโญโญโญ | โญโญโญ |
| ุงูุณุฑุนุฉ | โญโญโญโญโญ | โญโญโญโญ |
| ุงูุฃูุงู | ๐๐๐๐๐ | ๐๐๐๐๐ |
| ูุงุฌูุฉ UI | โ ุฌูููุฉ | โ Console |
| ูููุจุชุฏุฆูู | โ ูุซุงููุฉ | โ๏ธ ุชูููุฉ |

**ุงูุชูุตูุฉ:** ุงุณุชุฎุฏู ุงูุทุฑููุฉ 1 (ุตูุญุฉ Login) ูู ูุนุธู ุงูุญุงูุงุช

---

**ููุงุญุธุฉ:** ููููู ุญุฐู ูุฐุง ุงูููู ุจุนุฏ ุฅูุดุงุก ุฃูู admin ูุญูุธ ุจูุงูุงุชู!

**ููุฏุนู:** ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉุ ุชุญูู ูู:
1. ุฃู ุงูููุฏ ุงูุณุฑู ุตุญูุญ
2. ุฃู Edge Function ุชุนูู (ุชุญูู ูู Logs ูู Backend)
3. ุฃู RLS policies ููุนูุฉ ุนูู ุฌุฏูู user_roles
